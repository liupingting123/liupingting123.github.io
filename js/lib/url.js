define("lib/url",["config/url"],function(e){function t(e){this._fields={Username:4,Password:5,Port:7,Protocol:2,Host:6,Pathname:8,URL:0,Querystring:9,Fragment:10},this._values={},this._regex=null,this._regex=/^((\w+):\/\/)?((\w+):?(\w+)?@)?([^\/\?:]+):?(\d+)?(\/?[^\?#]+)?\??([^#]+)?#?(\w*)/;for(var t in this._fields)this["get"+t]=this._makeGetter(t)}return t.prototype={parse:function(e){this.url=e;for(var t in this._fields)this._values[t]="";var n=this._regex.exec(e);if(!n)throw"URLParser::_parse -> Invalid URL";for(var t in this._fields)typeof n[this._fields[t]]!="undefined"&&(this._values[t]=n[this._fields[t]]);if(this._values.Querystring.length){var r=this._values.Querystring,i={},s=r.split("&");for(var o=0;o<s.length;o++){var u=s[o],a=u.split("="),f=a[0],l=decodeURI(a[1]);if(f in i){if(!/array/i.test(Object.prototype.toString.call(i[f]))){var c=i[f];i[f]=[],i[f].push(c)}i[f].push(l)}else i[f]=l}this._values.Params=i}return this._values},_makeGetter:function(e){return this.refresh(),function(){return this._values[e]}},getParam:function(e){this.refresh();var t=this.getParamObject(e);return/array/i.test(Object.prototype.toString.call(t))?t[t.length-1]:t},getParamObject:function(e){return this.refresh(),this._values.Params?this._values.Params[e]?/array/i.test(Object.prototype.toString.call(this._values.Params[e]))?this._values.Params[e].map(function(e){return decodeURIComponent(e)}):decodeURIComponent(this._values.Params[e]):this._values.Params[e]:null},getHash:function(){return this.refresh(),location.hash},setHash:function(e){this.refresh(),"pushState"in history&&(e==""||e==null||e.length&&e.trim()=="")?history.pushState("",document.title,location.pathname+location.search):location.hash=e},replaceHash:function(e){this.refresh(),"replaceState"in history?history.replaceState("",document.title,location.pathname+location.search+(e==""?"":"#"+e)):location.hash=e},getDomainUrl:function(){return this.refresh(),e.localloginDomain},getTouchBaseUrl:function(){return this.refresh(),this.getDomainUrl()+"/"},getAllDomainUrl:function(){return this.refresh(),window.location.href},getHostUrl:function(){return this.refresh(),"http://"+window.location.host+"/"},refresh:function(){this.url!=location.href&&this.parse(location.href)},redirect:function(e){location.href=e},xss:function(e){return e==undefined||typeof e!="string"?e:(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e)}},new t(location.href)});