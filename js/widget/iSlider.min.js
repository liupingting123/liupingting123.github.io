!function(e){function t(e,t){return t.indexOf(e)>-1}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function i(e,t){r(e,t)||(e.className+=" "+t)}function s(e,t){r(e,t)&&(e.className=e.className.replace(RegExp("(\\s|^)"+t+"(\\s|$)"),""))}function o(e){if(/<\/?[^>]*>/g.test(e))return!1;var t="^(((https|http|ftp|rtsp|mms):)?//)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})?(:[0-9]{1,4})?([^?#]+)?(\\?[^#]+)?(#.+)?$";return(new RegExp(t)).test(e)}var u=function(){var e=Array.prototype.slice.call(arguments,0,3);if(!e.length)throw new Error("Parameters required!");var t="[object Object]"===Object.prototype.toString.call(e.slice(-1)[0])?e.pop():{};switch(e.length){case 2:t.data=t.data||e[1];case 1:t.dom=t.dom||e[0]}if(!t.dom)throw new Error("Container can not be empty!");if(!t.data||!t.data.length)throw new Error("Data must be an array and must have more than one element!");this._opts=t,this._LSN={},this._EventHandle={},t=e=null,this._setting(),this.fire("initialize"),this._renderWrapper(),this._initPlugins(),this._bindHandler()};u.EVENTS="initialize slide slideStart slideEnd slideChange slideChanged slideRestore slideRestored reloadData reset destroy".split(" "),u.EASING=["linear ease ease-in ease-out ease-in-out".split(" "),/cubic-bezier\(([^\d]*(\d+.?\d*)[^\,]*\,?){4}\)/],u.FIX_PAGE_TAGS="SELECT INPUT TEXTAREA BUTTON LABEL".split(" "),u.EMPTY_FUNCTION=function(){},u.extend=function(){var e,t,n=arguments;switch(n.length){case 0:return;case 1:e=u.prototype,t=n[0];break;case 2:e=n[0],t=n[1]}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},u.plugins={},u.regPlugin=function(e,t){u.plugins[e]=u.plugins[e]||t},u._animateFuncs={"default":function(e,t,n,r,i){e.style.webkitTransform="translateZ(0) translate"+t+"("+(i+n*(r-1))+"px)"}},u._transitionEndEvent=function(){var e;return function(){if(e)return e;var t=document.createElement("fakeElement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var r in n)if(n.hasOwnProperty(r)&&void 0!==t.style[r])return e=n[r]}}();var a=u.prototype;a.extend=u.extend,a._setting=function(){this._plugins=u.plugins,this._animateFuncs=u._animateFuncs,this.holding=!1,this.locking=!1;var r=this._opts;this.wrap=r.dom,this.data=r.data,this.isVertical=!!r.isVertical,this.isOverspread=!!r.isOverspread,this.duration=r.duration||2e3,this.initIndex=r.initIndex>0&&r.initIndex<r.data.length-1?r.initIndex:0,this.fixPage=null==r.fixPage?!0:!!r.fixPage,this.slideIndex=this.slideIndex||this.initIndex||0,this.axis=this.isVertical?"Y":"X",this.reverseAxis="Y"===this.axis?"X":"Y",this.width=this.wrap.clientWidth,this.height=this.wrap.clientHeight,this.ratio=this.height/this.width,this.scale=this.isVertical?this.height:this.width,this.offset=this.offset||{X:0,Y:0},this.isTouchable=null==r.isTouchable?!0:!!r.isTouchable,this.isLooping=r.isLooping&&this.data.length>1?!0:!1,this.delay=r.delay||0,this.isAutoplay=r.isAutoplay&&this.data.length>1?!0:!1,this.animateType=r.animateType in this._animateFuncs?r.animateType:"default",this._animateFunc=this._animateFuncs[this.animateType],this.isVertical&&"card"===this.animateType&&(this.isOverspread=!0),this.log=r.isDebug?function(){e.console.log.apply(e.console,arguments)}:u.EMPTY_FUNCTION,this._setUpDamping(),this.animateTime=null!=r.animateTime&&r.animateTime>-1?r.animateTime:300,this.animateEasing=t(r.animateEasing,u.EASING[0])||u.EASING[1].test(r.animateEasing)?r.animateEasing:"ease",this.inAnimate=0,this.deviceEvents=function(){var t=!!("ontouchstart"in e||e.DocumentTouch&&document instanceof e.DocumentTouch);return{hasTouch:t,startEvt:t?"touchstart":"mousedown",moveEvt:t?"touchmove":"mousemove",endEvt:t?"touchend":"mouseup"}}(),this.events={},this.on("slide",r.onslide,1),this.on("slideStart",r.onslidestart,1),this.on("slideEnd",r.onslideend,1),this.on("slideChange",r.onslidechange,1),this.on("slideChanged",r.onslidechanged,1),this.on("slideRestore",r.onsliderestore,1),this.on("slideRestored",r.onsliderestored,1),this.pluginConfig=function(){if(n(r.plugins)){var e={};return r.plugins.forEach(function(t){n(t)?e[t[0]]=t.slice(1):"string"==typeof t&&(e[t]=[])}),e}return{}}(),this.delay?e.setTimeout(this._autoPlay.bind(this),this.delay):this._autoPlay()},a._initPlugins=function(){var e=this.pluginConfig,t=this._plugins;for(var n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(this.log("[INIT PLUGIN]:",n,t[n]),t[n]&&"function"==typeof t[n]&&typeof t[n].apply&&t[n].apply(this,e[n]))},a._setUpDamping=function(){var e=this.scale>>1,t=e>>1,n=t>>2;this._damping=function(r){var i,s=Math.abs(r);return i=e>s?s>>1:e+t>s?t+(s-e>>2):t+n+(s-e-t>>3),r>0?i:-i}},a._itemType=function(e){if(isNaN(e)||(e=this.data[e]),e.hasOwnProperty("type"))return e.type;var t,n=e.content;return t=null==n?"empty":Boolean(n.nodeName)&&Boolean(n.nodeType)?"node":"string"==typeof n?o(n)?"pic":"html":"unknown",e.type=t,t},a._renderItem=function(e,t){var n,r=this,i=this.data.length,s=function(){var t=' src="'+n.content+'"';t+=n.height/n.width>r.ratio?' height="100%"':' width="100%"',r.isOverspread&&(e.style.cssText="background:url("+n.content+") no-repeat 50% 50%;background-size:cover",t+=' style="display:block;opacity:0;height:100%;width:100%;"'),e.innerHTML="<img"+t+" />"};if(e.innerHTML="",e.style.background="",this.isLooping||null!=this.data[t]){t=(i+t)%i,n=this.data[t];var o=this._itemType(n);switch(this.log("[Render ITEM]:",o,t,n),e.className="islider-"+o,o){case"pic":if(2===n.load)s();else{var u=new Image;u.src=n.content,u.onload=function(){n.height=u.height,n.width=u.width,s(),n.load=2}}break;case"dom":case"html":e.innerHTML=n.content;break;case"node":case"element":if(11===n.content.nodeType){var a=document.createElement("div");a.appendChild(n.content),n.content=a}e.appendChild(n.content)}this.fire("renderComplete")}},a._renderIntermediateScene=function(){null!=this._intermediateScene&&(this._renderItem.apply(this,this._intermediateScene),this._intermediateScene=null)},a._changedStyles=function(){var e=["islider-prev","islider-active","islider-next"];this.els.forEach(function(t,n){s(t,"("+e.join("|")+")"),i(t,e[n])})},a._renderWrapper=function(){this.outer&&(this.outer.innerHTML="");var t=this.outer||document.createElement("ul");t.className="islider-outer",this.els=[];for(var n=0;3>n;n++){var r=document.createElement("li");this.els.push(r),this._animateFunc(r,this.axis,this.scale,n,0),this.fixPage||(r.style.overflow="auto"),!this.isVertical||"rotate"!==this.animateType&&"flip"!==this.animateType?this._renderItem(r,n-1+this.slideIndex):this._renderItem(r,1-n+this.slideIndex),t.appendChild(r)}this._changedStyles(),e.setTimeout(function(){this._preloadImg(this.slideIndex)}.bind(this),200),this.outer||(this.outer=t,this.wrap.appendChild(t))},a._preloadImg=function(e){if(this.data.length>3){var t=this.data,n=t.length,r=this,i=function(e){var n=t[e];if("pic"===r._itemType(n)&&!n.load){var i=new Image;i.src=n.content,i.onload=function(){n.width=i.width,n.height=i.height,n.load=2},n.load=1}};i((e+2)%n),i((e-2+n)%n)}},a._watchTransitionEnd=function(t,n){function r(t){s&&e.clearTimeout(s),o.inAnimate--,o.log("Event:","watchTransitionEnd::stuck::release",o.inAnimate),0===o.inAnimate&&("slideChanged"===n&&o._changedStyles(),o.fire.apply(o,a),o._renderIntermediateScene()),i()}function i(){o.els.forEach(function(e){e.removeEventListener(u._transitionEndEvent(),r)}),o.isAnimating=!1}var s,o=this,a=Array.prototype.slice.call(arguments,1);this.log("Event:","watchTransitionEnd::stuck::pile",this.inAnimate),t>0&&o.els.forEach(function(e){e.addEventListener(u._transitionEndEvent(),r)}),s=e.setTimeout(r,t),o.inAnimate++},a._bindHandler=function(){var t=this.outer;if(this.isTouchable){var n=this.deviceEvents;n.hasTouch||(t.style.cursor="pointer",t.ondragstart=function(e){return e?!1:!0}),t.addEventListener(n.startEvt,this),t.addEventListener(n.moveEvt,this),t.addEventListener(n.endEvt,this),!this.deviceEvents.hasTouch&&t.addEventListener("mouseout",this)}e.addEventListener("orientationchange",this),e.addEventListener("resize",this),e.addEventListener("focus",this,!1),e.addEventListener("blur",this,!1)},a.handleEvent=function(e){var t=this.deviceEvents;switch(e.type){case"mousedown":if(0!==e.button)break;case"touchstart":this.startHandler(e);break;case t.moveEvt:this.moveHandler(e);break;case t.endEvt:case"mouseout":case"touchcancel":this.endHandler(e);break;case"orientationchange":this.orientationchangeHandler();break;case"focus":this._autoPlay();break;case"blur":this.pause();break;case"resize":this.resizeHandler()}},a.startHandler=function(e){if(this.fixPage&&u.FIX_PAGE_TAGS.indexOf(e.target.tagName)<0&&e.preventDefault(),!this.holding&&!this.locking){var t=this.deviceEvents;this.isMoving=!0,this.pause(),this.log("Event: start"),this.fire("slideStart",e,this),this.startTime=(new Date).getTime(),this.startX=t.hasTouch?e.targetTouches[0].pageX:e.pageX,this.startY=t.hasTouch?e.targetTouches[0].pageY:e.pageY}},a.moveHandler=function(e){if(this.isMoving){this.log("Event: moving");var t=this.deviceEvents,n=this.data.length,r=this.axis,i=this.reverseAxis,s={X:t.hasTouch?e.targetTouches[0].pageX-this.startX:e.pageX-this.startX,Y:t.hasTouch?e.targetTouches[0].pageY-this.startY:e.pageY-this.startY};if(this.offset=s,Math.abs(s[r])-Math.abs(s[i])>10){e.preventDefault(),this.fire("slide",e,this),this.isLooping||(s[r]>0&&0===this.slideIndex||s[r]<0&&this.slideIndex===n-1)&&(s[r]=this._damping(s[r]));for(var o=0;3>o;o++){var u=this.els[o];u.style.webkitTransition="all 0s",this._animateFunc(u,r,this.scale,o,s[r])}}}},a.endHandler=function(t){if(this.isMoving){this.log("Event: end"),this.isMoving=!1;var n=this.offset,r=this.axis,i=this.scale/2,s=(new Date).getTime();i=s-this.startTime>300?i:14;var o=Math.abs(n[r]),u=Math.abs(n[this.reverseAxis]),a=function(t){if("A"===t.tagName){if(t.href)return e.location.href=t.href,!1}else{if("islider-pic"!==t.className)return!1;a(t.parentNode)}};this.log(i,n[r],o,u,this),n[r]>=i&&o>u?this.slideTo(this.slideIndex-1):n[r]<-i&&o>u?this.slideTo(this.slideIndex+1):this.slideTo(this.slideIndex),Math.abs(this.offset.X)<10&&Math.abs(this.offset.Y)<10&&(this.tapEvt=document.createEvent("Event"),this.tapEvt.initEvent("tap",!0,!0),this.fixPage&&t.target&&a(t.target),t.target.dispatchEvent(this.tapEvt)||t.preventDefault()),this.offset.X=this.offset.Y=0,this._autoPlay(),this.fire("slideEnd",t,this)}},a.orientationchangeHandler=function(){e.setTimeout(function(){this.reset(),this.log("Event: orientationchange")}.bind(this),100)},a.resizeHandler=function(){(this.height!==this.wrap.clientHeight||this.width!==this.wrap.clientWidth)&&(this._LSN.resize&&e.clearTimeout(this._LSN.resize),this._LSN.resize=e.setTimeout(function(){this.reset(),this.log("Event: resize"),this._LSN.resize&&e.clearTimeout(this._LSN.resize)}.bind(this),500))},a.slideTo=function(t,n){if(!this.locking){this.unhold();var r,i=this.animateTime,s=this.animateType,o=this._animateFunc,u=this.data,a=this.els,f=t,l=t-this.slideIndex,c=this.offset;"object"==typeof n&&(n.animateTime>-1&&(i=n.animateTime),"string"==typeof n.animateType&&n.animateType in this._animateFuncs&&(s=n.animateType,o=this._animateFuncs[s]));var h=Math.abs(c[this.axis])/this.scale*i;Math.abs(l)>1&&this._renderItem(l>0?this.els[2]:this.els[0],f),this._preloadImg(f),u[f]?this.slideIndex=f:this.isLooping?this.slideIndex=l>0?0:u.length-1:(this.slideIndex=this.slideIndex,l=0),this.log("Index:"+this.slideIndex);var p,d,v;0===l?r="slideRestore":((this.isVertical&&("rotate"===s||"flip"===s))^l>0?(a.push(a.shift()),p=a[2],d=a[0],v=1):(a.unshift(a.pop()),p=a[0],d=a[2],v=-1),1===Math.abs(l)?(this._renderIntermediateScene(),this._renderItem(p,f+l)):Math.abs(l)>1&&(this._renderItem(p,f+v),this._intermediateScene=[d,f-v]),p.style.webkitTransition="none",p.style.visibility="hidden",e.setTimeout(function(){p.style.visibility="visible"},200),h=i-h,r="slideChange"),this.fire(r,this.slideIndex,a[1],this),this._watchTransitionEnd(h,r+"d",this.slideIndex,a[1],this);for(var m=0;3>m;m++)a[m]!==p&&(a[m].style.webkitTransition="all "+h/1e3+"s "+this.animateEasing),o.call(this,a[m],this.axis,this.scale,m,0);this.isAutoplay&&!this.isLooping&&this.slideIndex===u.length-1&&this.pause()}},a.slideNext=function(){this.slideTo.apply(this,[this.slideIndex+1].concat(Array.prototype.slice.call(arguments)))},a.slidePrev=function(){this.slideTo.apply(this,[this.slideIndex-1].concat(Array.prototype.slice.call(arguments)))},a.regPlugin=function(){var e=Array.prototype.slice.call(arguments),n=e.shift(),r=e[0];(this._plugins.hasOwnProperty(n)||"function"==typeof r)&&("function"==typeof r&&(this._plugins[n]=r,e.shift()),t(n,this._opts.plugins)||(this._opts.plugins.push(e.length?[].concat([n],e):n),"function"==typeof this._plugins[n]&&this._plugins[n].apply(this,e)))},a.bind=a.delegate=function(t,n,r){function i(t){for(var i=e.event?e.event:t,s=i.target,o=document.querySelectorAll(n),u=0;u<o.length;u++)if(s===o[u]){r.call(s);break}}this.wrap.addEventListener(t,i,!1);var s=t+";"+n;this._EventHandle.hasOwnProperty(s)?(this._EventHandle[s][0].push(r),this._EventHandle[s][1].push(i)):this._EventHandle[s]=[[r],[i]]},a.unbind=a.unDelegate=function(e,t,n){var r=e+";"+t;if(this._EventHandle.hasOwnProperty(r)){var i=this._EventHandle[r][0].indexOf(n);if(i>-1)return this.wrap.removeEventListener(e,this._EventHandle[r][1][i]),this._EventHandle[r][0][i]=this._EventHandle[r][1][i]=null,!0}return!1},a.destroy=function(){var t=this.outer,n=this.deviceEvents;this.fire("destroy"),this.isTouchable&&(t.removeEventListener(n.startEvt,this),t.removeEventListener(n.moveEvt,this),t.removeEventListener(n.endEvt,this),!this.deviceEvents.hasTouch&&t.removeEventListener("mouseout",this)),e.removeEventListener("orientationchange",this),e.removeEventListener("focus",this),e.removeEventListener("blur",this);for(var r in this._EventHandle)for(var i=this._EventHandle[r][1],s=0;s<i.length;s++)"function"==typeof i[s]&&this.wrap.removeEventListener(r.substr(0,r.indexOf(";")),i[s]);this._EventHandle=null;for(var r in this._LSN)this._LSN.hasOwnProperty(r)&&this._LSN[r]&&e.clearTimeout(this._LSN[r]);this._LSN=null,this.wrap.innerHTML=""},a.on=function(e,n,r){t(e,u.EVENTS)&&"function"==typeof n&&(!(e in this.events)&&(this.events[e]=[]),r?this.events[e].unshift(n):this.events[e].push(n))},a.has=function(e,t){return e in this.events?this.events[e].indexOf(t):-1},a.off=function(e,t){var n=this.has(e,t);n>-1&&delete this.events[e][n]},a.fire=function(e){if(this.log("[EVENT FIRE]:",e,arguments),e in this.events)for(var t=this.events[e],n=0;n<t.length;n++)"function"==typeof t[n]&&t[n].apply&&t[n].apply(this,Array.prototype.slice.call(arguments,1))},a.reset=function(){this.pause(),this._setting(),this._renderWrapper(),this.delay&&e.setTimeout(this._autoPlay.bind(this),this.delay)},a.loadData=function(t,n){this.pause(),this.slideIndex=n||0,this.data=t,this._renderWrapper(),this.fire("reloadData"),this.delay&&e.setTimeout(this._autoPlay.bind(this),this.delay)},a._autoPlay=function(){this.isAutoplay?(this.has("slideChanged",this.play)<0&&this.on("slideChanged",this.play,1),this.has("slideRestored",this.play)<0&&this.on("slideRestored",this.play,1),this.play()):(this.off("slideChanged",this.play),this.off("slideRestored",this.play))},a.play=function(){this._LSN.autoPlay&&e.clearTimeout(this._LSN.autoPlay),this._LSN.autoPlay=e.setTimeout(this.slideNext.bind(this),this.duration)},a.pause=function(){this._LSN.autoPlay&&e.clearTimeout(this._LSN.autoPlay)},a.hold=function(){this.holding=!0},a.unhold=function(){this.holding=!1,this.unlock()},a.lock=function(){this.hold(),this.locking=!0},a.unlock=function(){this.locking=!1},"function"==typeof require&&"object"==typeof module&&module&&"object"==typeof exports&&exports?module.exports=u:"function"==typeof define&&define.amd?define([],function(){return u}):e.iSlider=e.iSlider||u}(this||window);